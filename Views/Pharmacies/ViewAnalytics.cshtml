@model NewWebApplicationProject.Models.Pharmacy

@{
    ViewData["Title"] = "Analytics for Pharmacy: " + Model.PharmacyName;
}

<h1>@ViewData["Title"]</h1>

<div class="card mb-4">
    <div class="card-header">
        <h4>Pharmacy Details</h4>
    </div>
    <div class="card-body">
        <p><strong>Pharmacy Name:</strong> @Model.PharmacyName</p>
        <p><strong>License Number:</strong> @Model.LicenseNumber</p>
        <p><strong>Address:</strong> @Model.Address</p>
        <p><strong>Email:</strong> @Model.Email</p>
        <p><strong>Phone:</strong> @Model.PhoneNumber</p>
    </div>
</div>

<div class="card mb-4">
    <div class="card-header">
        <h4>Analytics Overview</h4>
    </div>
    <div class="card-body">
        <p><strong>Total Unique Medicines:</strong> @ViewBag.TotalMedicines</p>
        <p><strong>Total Stock Quantity:</strong> @ViewBag.TotalStock</p>
        <p><strong>Low Stock Items (&lt; 10 units):</strong> @ViewBag.LowStockItems</p>
        <p><strong>Out of Stock Items:</strong> @ViewBag.OutOfStockItems</p>
        <p><strong>Total Purchases:</strong> @ViewBag.TotalPurchases</p>
    </div>
</div>

<div class="card mb-4">
    <div class="card-header">
        <h4>Inventory Details</h4>
    </div>
    <div class="card-body">
        @if (Model.Inventory != null && Model.Inventory.Any())
        {
            <table class="table">
                <thead>
                    <tr>
                        <th>Medicine Name</th>
                        <th>Quantity</th>
                        <th>Last Updated</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.Inventory)
                    {
                        <tr>
                            <td>@item.Medicine?.Name</td>
                            <td>@item.Quantity</td>
                            <td>@item.LastUpdated.ToString("g")</td>
                        </tr>
                    }
                </tbody>
            </table>
        }
        else
        {
            <p>No inventory data available for this pharmacy.</p>
        }
    </div>
</div>

<div class="card mb-4">
    <div class="card-header">
        <h4>Purchase Details</h4>
    </div>
    <div class="card-body">
        @if (Model.Purchases != null && Model.Purchases.Any())
        {
            <table class="table">
                <thead>
                    <tr>
                        <th>Purchase ID</th>
                        <th>Patient Name</th>
                        <th>Medicine Name</th>
                        <th>Quantity</th>
                        <th>Purchase Date</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var purchase in Model.Purchases)
                    {
                        <tr>
                            <td>@purchase.PurchaseId</td>
                            <td>@purchase.Patient?.Name</td>
                            <td>@purchase.Medicine?.Name</td>
                            <td>@purchase.Quantity</td>
                            <td>@purchase.PurchaseDate.ToString("g")</td>
                        </tr>
                    }
                </tbody>
            </table>
        }
        else
        {
            <p>No purchase data available for this pharmacy.</p>
        }
    </div>
</div>

<a asp-controller="Pharmacies" asp-action="Index" class="btn btn-secondary">Back to Pharmacies</a>
